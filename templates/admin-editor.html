<div style="max-width:100%;margin:auto">
	<p>
		Any changes you make here will simply be appended to <a href="{{ file }}"><code>{{ file }}</code></a>. If you wish to make the most of Tinyboard's customizability, you can instead edit the file directly. This page is intended for making quick changes and for those who don't have a basic understanding of PHP code.
	</p>

	{% if readonly %}
		<p>Tinyboard does not have the required permissions to edit <code>{{ file }}</code>. To make changes, you will need to change permissions of the file first or manually edit the code.</p>
	{% endif %}
	
	
	{% if not readonly %}<form method="post" action="">{% endif %}
		<input type="hidden" name="listbox" value="{{ file }}">
		<input type="hidden" name="token" value="{{ token }}">
		<textarea name="code" id="code" class="w3-theme-light w3-tiny" style="margin:auto;width:100%;height:500px{% if readonly %};background:#eee"{% else %}"{% endif %}>{{ php }}</textarea>
		
		<ul style="padding:0;text-align:center;list-style:none">
			<li><input name="save"  class="w3-theme-light" type="submit" value="{% trans 'Save changes' %}"{% if readonly %} disabled{% endif %}></li>
		</ul>
	{% if not readonly %}</form>{% endif %}
</div>
<script type="text/javascript">
var observe;
if (window.attachEvent) {
	observe = function (element, event, handler) {
		element.attachEvent('on'+event, handler);
	};
}
else {
	observe = function (element, event, handler) {
		element.addEventListener(event, handler, false);
	};
}
var text = document.getElementById('code');
function resize () {
	//text.style.height = 'auto';
	//text.style.height = text.scrollHeight+'px';
}
/* 0-timeout to get the already changed text */
function delayedResize () {
	//window.setTimeout(resize, 0);
}
observe(text, 'change',  resize);
observe(text, 'cut',     delayedResize);
observe(text, 'paste',   delayedResize);
observe(text, 'drop',    delayedResize);
observe(text, 'keydown', function(e) {
    if (e.keyCode == 13) {
        delayedResize();
    }
});
resize();
</script>